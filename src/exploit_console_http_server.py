import http.server
import socketserver


class CustomHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        # Serve the exploit console on *any* path:
        self.send_response(200)
        self.send_header("Content-Type", "text/html; charset=utf-8")
        self.end_headers()
        with open("exploit_console.html", "rb") as f:
            self.wfile.write(f.read())


def main():
    for port in range(8000, 8100):
        try:
            with socketserver.TCPServer(("", port), CustomHandler) as httpd:
                print(f"Serving the exploit console at http://localhost:{port}")
                httpd.serve_forever()
        except OSError as e:
            if e.errno == 48:  # Address already in use:
                continue  # try another port...
    print("Error: no port between 8000 and 8099 could be assigned.")


if __name__ == "__main__":
    main()
